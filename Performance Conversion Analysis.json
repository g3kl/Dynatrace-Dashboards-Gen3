{"version":13,"variables":[{"key":"AppName","type":"code","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n const lastXDays = 30;\n const usqlQuery = 'SELECT DISTINCT application FROM useraction where matchingconversiongoals is not null';\n const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n const sampleCount = response.values.length;\n function flatten(arr) {\n    var flat = [];\n    for (var i = 0; i < sampleCount; i++) {\n        flat = flat.concat(arr[i]);\n    }\n    return flat;\n}\n return( flatten(response.values))\n}","multiple":false},{"key":"ConversionGoal","type":"code","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const lastXDays = 30;\n  const usqlQuery = 'select stringProperties FROM usersession limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n  let arr = [];\n  (response.values).forEach(e2 => {\n    (e2).forEach(e3 => {\n      (e3).forEach(e => {\n        arr.push(e.key);\n      });\n    });\n  });\n  return( arr)\n}","multiple":false},{"key":"AvgOrderValue","type":"csv","input":"100,200,300,400,500,600,700,800,900,1000,495","multiple":false},{"key":"kpiLimit","type":"csv","input":"3,4,5,6,7,8,9,10,11,12","multiple":false},{"key":"KeyUserAction","type":"code","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\n\n\nexport default async function () {\n   const usqlQuery = 'SELECT DISTINCT name,count(*) FROM useraction WHERE keyuseraction is true order by count(*) desc';\n const lastXDays = 30;\n const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n\nconst sampleCount = response.values.length;\n function flatten(arr) {\n    var flat = [];\n    for (var i = 0; i < sampleCount; i++) {\n//        flat = flat.concat(arr[i]);\nflat = flat.concat(arr[i][0].replace(/\"/g, \"\\\\\\\"\"));\n    }\n    return flat;\n}\n return( flatten(response.values))\n\n}","multiple":false}],"tiles":{"8":{"title":"","type":"markdown","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"36":{"title":"","type":"markdown","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"76":{"type":"markdown","title":"","content":"[**Help**](https://github.com/TechShady/Dynatrace-Dashboards-Gen3/blob/main/ReadMePerformanceConversionAnalysisApplication.md#user-guide)"},"144":{"title":"","type":"markdown","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"148":{"title":"","type":"markdown","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"149":{"type":"code","title":"","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var tuningGoal = 0;\n  var appsList = \"\\\"\" + $AppName.replace(/\"/g, \"\\\"\\\"\") + \"\\\"\";\n  var usqlQuery = 'select distinct name as \"User Actions\",count(*) as \"Requests\", CONDITION(COUNT(*), WHERE isExitAction=true) as \"Exits\" from useraction where application in (' + appsList + ') and starttime>=' + startTime + ' and endtime<=' + endTime + ' order by Requests DESC limit 500';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  const sampleCount = response.values.length;\n  var sumRiskAbandons = 0;\n  var query4 = 'SELECT CONDITION (count(*),WHERE starttime>=' + startTime + ' and endtime<=' + endTime + ') as \"Current Sessions\", CONDITION (count(*),WHERE usersession.stringProperties.' + $ConversionGoal + ' is not null and starttime>=' + startTime + ' and endtime<=' + endTime + ') as \"Current Conversions\" FROM usersession WHERE useraction.application in (' + appsList + ') and starttime>=' + startTime + ' and endtime<=' + endTime;\n  const result4 = await rumUserSessionsClient.getUsqlResultAsTable({query: query4, startTimestamp: startTime, endTimestamp: endTime});\n  for (var i = 0; i < sampleCount; i++) {\n    var actionName = response.values[i][0].replace(/\"/g, \"\\\"\\\"\");\n    var query1 = 'SELECT count(distinct usersession.usersessionid) FROM useraction WHERE application in (' + appsList + ') and name=\"' + actionName + '\" and usersession.stringproperties.' + $ConversionGoal + ' is null and useraction.duration>(1000*' + $kpiLimit + ') and isexitaction is true and starttime>=' + startTime + ' and endtime<=' + endTime;\n    var query2 = 'SELECT AVG(useraction.duration),count(distinct usersession.usersessionid) FROM useraction WHERE application in (' + appsList + ') and name=\"' + actionName + '\" and usersession.stringproperties.' + $ConversionGoal + ' is not null and starttime>=' + startTime + ' and endtime<=' + endTime;\n    var query3 = 'SELECT AVG(useraction.duration),count(distinct usersession.usersessionid) FROM useraction WHERE application in (' + appsList + ') and name=\"' + actionName + '\" and usersession.stringproperties.' + $ConversionGoal + ' is null and useraction.duration>(1000*' + $kpiLimit + ') and isexitaction is true and starttime>=' + startTime + ' and endtime<=' + endTime;\n    const result1 = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: startTime, endTimestamp: endTime});\n    const result2 = await rumUserSessionsClient.getUsqlResultAsTable({query: query2, startTimestamp: startTime, endTimestamp: endTime});\n    const result3 = await rumUserSessionsClient.getUsqlResultAsTable({query: query3, startTimestamp: startTime, endTimestamp: endTime});\n    response.values[i][3] = result1[\"values\"][0][0];\n    response.values[i][4] = result2[\"values\"][0][0] + 0;\n    response.values[i][5] = result3[\"values\"][0][0] + 0;\n    response.values[i][6] = result1[\"values\"][0][0] * result4[\"values\"][0][1] / result4[\"values\"][0][0];\n    sumRiskAbandons = sumRiskAbandons+result1[\"values\"][0][0];\n  }\nconsole.log(sumRiskAbandons)\n  let returnData = {\n    records: new Array(sampleCount).fill(null).map((_, index, array) => {\n      response.values[index][2] = (response.values[index][2] / response.values[index][1] * 100).toFixed(2) + \"%\";\n      if (response.values[index][4] > response.values[index][5]) tuningGoal = 0;\n      else tuningGoal = response.values[index][4] - response.values[index][5];\n\n      let dataRecords = {\n        'User Action': response.values[index][0],\n        'Requests': response.values[index][1],\n        'Exit Rate': response.values[index][2],\n        'Risk Abandons': response.values[index][3],\n        'Conversion Duration': response.values[index][4],\n        'Risk Abandon Duration': response.values[index][5],\n        'Tuning Goal': tuningGoal,\n        'Projected Conversions': response.values[index][6],\n        'Projected Financial Gain': ((response.values[index][6] * $AvgOrderValue)),\n        'Projected Annualized Gain': ((response.values[index][6] * $AvgOrderValue * 365 / ((endTime - startTime) / 24 / 60 / 60 / 1000))),\n      };\n      return dataRecords;\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n          'User Action': { type: 'string' },\n          'Requests': { type: 'double' },\n          'Exit Rate': { type: 'double' },\n          'Risk Abandons': { type: 'double' },\n          'Conversion Duration': { type: 'double' },\n          'Risk Abandon Duration': { type: 'double' },\n          'Tuning Goal': { type: 'double' },\n          'Projected Conversions': { type: 'double' },\n          'Projected Financial Gain': { type: 'double' },\n          'Projected Annualized Gain': { type: 'double' }\n        },\n      },\n    ],\n  };\n  return returnData;\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Risk Abandons","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"=","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":30}]},{"id":2,"field":"Conversion Duration","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":3000},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":12000}]},{"id":3,"field":"Risk Abandon Duration","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":3000},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":12000}]},{"id":4,"field":"Projected Conversions","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":">","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"=","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":""}]},{"id":5,"field":"Tuning Goal","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¤","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¤","label":"","value":-3000},{"id":2,"color":"#F8312F","comparator":"â‰¤","label":"","value":-12000}]},{"id":6,"field":"Projected Financial Gain","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":">","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"=","label":"","value":0},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":"â‰¥","label":""}]},{"id":7,"field":"Projected Annualized Gain","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"=","label":"","value":0},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":"â‰¥","label":""}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoricalBarChartSettings":{"categoryAxis":"User Action","categoryAxisLabel":"User Action","valueAxis":"Requests","valueAxisLabel":"Requests"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"User Action"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"User Action\"]":413.171875,"[\"Requests\"]":107.109375,"[\"Exit Rate\"]":105.765625,"[\"Risk Abandons\"]":141.859375,"[\"Conversion KPI\"]":144.703125,"[\"Risk Abandon KPI\"]":161.203125,"[\"Projected Conversions\"]":189.390625,"[\"Projected Financial Gain\"]":202.140625,"[\"Projected Annualized Gain\"]":215.46875,"[\"Conversion Duration\"]":177.09375,"[\"Risk Abandon Duration\"]":193.578125,"[\"Tuning Goal (ms)\"]":155.875},"sortBy":{"columnId":"[\"Projected Annualized Gain\"]","direction":"descending"}},"unitsOverrides":[{"identifier":"Requests","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1705596009202},{"identifier":"Exit Rate","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1705596019571},{"identifier":"Risk Abandons","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1705596030936},{"identifier":"Conversion Duration","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1705596049339},{"identifier":"Risk Abandon Duration","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1705596107180},{"identifier":"Projected Conversions","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":true,"added":1705596147136},{"identifier":"Tuning Goal","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":3,"suffix":"","delimiter":false,"added":1705860774690},{"identifier":"Projected Financial Gain","unitCategory":"currency","baseUnit":"usd","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1706118158027},{"identifier":"Projected Annualized Gain","unitCategory":"currency","baseUnit":"usd","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1706118226578}],"histogram":{"dataMappings":[{"valueAxis":"Requests","rangeAxis":""},{"valueAxis":"Exit Rate","rangeAxis":""},{"valueAxis":"Risk Abandons","rangeAxis":""},{"valueAxis":"Conversion Duration","rangeAxis":""},{"valueAxis":"Risk Abandon Duration","rangeAxis":""},{"valueAxis":"Tuning Goal","rangeAxis":""},{"valueAxis":"Projected Conversions","rangeAxis":""},{"valueAxis":"Projected Financial Gain","rangeAxis":""},{"valueAxis":"Projected Annualized Gain","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"150":{"type":"code","title":"Region Distribution","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName.replace(/\"/g, \"\\\"\\\"\")+\"\\\"\";\n  const usqlQuery = 'select distinct usersession.region as \"Region\", count(distinct usersession.usersessionid) as \"Abandons\" FROM useraction WHERE application in ('+appsList+') and usersession.stringproperties.'+$ConversionGoal+' is null and useraction.duration>(1000*'+$kpiLimit+') and isexitaction is true and starttime>='+startTime+' and endtime<='+endTime+' and usersession.usertype=\"REAL_USER\" and usersession.region is not null order by count(distinct usersession.usersessionid) DESC LIMIT 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  const sampleCount = response.values.length;\n    return {\n    records: new Array(sampleCount).fill(null).map((_, index, array) => {\n      \n      return {\n        'Region': response.values[index][0],\n        'Abandons': response.values[index][1]      \n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n         \n          'Region': { type: 'string' },\n          'Abandons': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"pieChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"legend":{"position":"right","hidden":false},"categoricalBarChartSettings":{"categoryAxis":"Region","categoryAxisLabel":"Region","valueAxis":"Abandons","valueAxisLabel":"Abandons"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Region"},"table":{"rowDensity":"condensed","enableLineWrap":false,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[{"valueAxis":"Abandons","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"151":{"type":"code","title":"Browser Version Distribution","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName.replace(/\"/g, \"\\\"\\\"\")+\"\\\"\";\n  const usqlQuery = 'select usersession.browserMajorVersion as \"Browser\", count(distinct usersession.usersessionid) as \"Abandons\" FROM useraction WHERE application in ('+appsList+') and usersession.stringproperties.'+$ConversionGoal+' is null and useraction.duration>(1000*'+$kpiLimit+') and isexitaction is true and starttime>='+startTime+' and endtime<='+endTime+' and usersession.usertype=\"REAL_USER\" and usersession.browserMajorVersion is not null group by browser order by count(distinct usersession.usersessionid) DESC LIMIT 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  const sampleCount = response.values.length;\n    return {\n    records: new Array(sampleCount).fill(null).map((_, index, array) => {\n      \n      return {\n        'Browser': response.values[index][0],\n        'Abandons': response.values[index][1]      \n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n         \n          'Browser': { type: 'string' },\n          'Abandons': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"pieChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"legend":{"position":"right","hidden":false},"categoricalBarChartSettings":{"categoryAxis":"Browser","categoryAxisLabel":"Browser","valueAxis":"Abandons","valueAxisLabel":"Abandons"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Browser"},"table":{"rowDensity":"condensed","enableLineWrap":false,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[{"valueAxis":"Abandons","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"152":{"type":"code","title":"Browser Family Distribution","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName.replace(/\"/g, \"\\\"\\\"\")+\"\\\"\";\n  const usqlQuery = 'select usersession.browserFamily as \"Browser\", count(distinct usersession.usersessionid) as \"Abandons\" FROM useraction WHERE application in ('+appsList+') and usersession.stringproperties.'+$ConversionGoal+' is null and useraction.duration>(1000*'+$kpiLimit+') and isexitaction is true and starttime>='+startTime+' and endtime<='+endTime+' and usersession.usertype=\"REAL_USER\" and usersession.browserFamily is not null group by browser order by count(distinct usersession.usersessionid) DESC LIMIT 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  const sampleCount = response.values.length;\n    return {\n    records: new Array(sampleCount).fill(null).map((_, index, array) => {\n      \n      return {\n        'Browser': response.values[index][0],\n        'Abandons': response.values[index][1]      \n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n         \n          'Browser': { type: 'string' },\n          'Abandons': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"pieChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"legend":{"position":"right","hidden":false},"categoricalBarChartSettings":{"categoryAxis":"Browser","categoryAxisLabel":"Browser","valueAxis":"Abandons","valueAxisLabel":"Abandons"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Browser"},"table":{"rowDensity":"condensed","enableLineWrap":false,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[{"valueAxis":"Abandons","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"153":{"type":"markdown","title":"","content":"### Risk Abandon Distribution "},"154":{"type":"markdown","title":"","content":"### Risk Abandon Summary"},"156":{"type":"code","title":"Requests","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName.replace(/\"/g, \"\\\"\\\"\")+\"\\\"\";\n  const query = 'SELECT count(*) from useraction WHERE useraction.application in ('+appsList+')  and starttime>='+startTime+' and endtime<='+endTime;\n  export default async function () {\n  const result = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: startTime, endTimestamp: endTime});\n  return result[\"values\"][0][0];\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true,"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"157":{"type":"code","title":"Sessions","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName.replace(/\"/g, \"\\\"\\\"\")+\"\\\"\";\n  const query = 'SELECT count(*) from usersession WHERE useraction.application in ('+appsList+') and starttime>='+startTime+' and endtime<='+endTime;\n  export default async function () {\n  const result = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: startTime, endTimestamp: endTime});\n  return result[\"values\"][0][0];\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true,"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"158":{"type":"code","title":"Conversion Trend by \"$KeyUserAction\" Performance Increase","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  const usqlQuery1 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>3000 and duration<=4000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery2 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>3000 and duration<=4000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery3 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>4000 and duration<=5000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery4 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>4000 and duration<=5000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery5 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>5000 and duration<=6000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery6 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>5000 and duration<=6000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery7 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>6000 and duration<=7000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery8 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>6000 and duration<=7000 and starttime>='+startTime+' and endtime<='+endTime;  \n  const usqlQuery9 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>7000 and duration<=8000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery10 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>7000 and duration<=8000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery11 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>8000 and duration<=9000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery12 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>8000 and duration<=9000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery13 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>9000 and duration<=10000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery14 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>9000 and duration<=10000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery15 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>10000 and duration<=11000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery16 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>10000 and duration<=11000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery17 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>11000 and duration<=12000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery18 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>11000 and duration<=12000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery19 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>12000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery20 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>12000 and starttime>='+startTime+' and endtime<='+endTime;\n  const response1 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery1,startTimestamp: startTime, endTimestamp: endTime });\n  const response2 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery2,startTimestamp: startTime, endTimestamp: endTime });\n  const response3 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery3,startTimestamp: startTime, endTimestamp: endTime });\n  const response4 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery4,startTimestamp: startTime, endTimestamp: endTime });\n  const response5 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery5,startTimestamp: startTime, endTimestamp: endTime });\n  const response6 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery6,startTimestamp: startTime, endTimestamp: endTime });\n  const response7 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery7,startTimestamp: startTime, endTimestamp: endTime });\n  const response8 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery8,startTimestamp: startTime, endTimestamp: endTime });\n  const response9 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery9,startTimestamp: startTime, endTimestamp: endTime });\n  const response10 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery10,startTimestamp: startTime, endTimestamp: endTime });\n  const response11 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery11,startTimestamp: startTime, endTimestamp: endTime });\n  const response12 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery12,startTimestamp: startTime, endTimestamp: endTime });\n  const response13 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery13,startTimestamp: startTime, endTimestamp: endTime });\n  const response14 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery14,startTimestamp: startTime, endTimestamp: endTime });\n  const response15 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery15,startTimestamp: startTime, endTimestamp: endTime });\n  const response16 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery16,startTimestamp: startTime, endTimestamp: endTime });\n  const response17 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery17,startTimestamp: startTime, endTimestamp: endTime });\n  const response18 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery18,startTimestamp: startTime, endTimestamp: endTime });\n  const response19 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery19,startTimestamp: startTime, endTimestamp: endTime });\n  const response20 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery20,startTimestamp: startTime, endTimestamp: endTime });\n  if (response2[\"values\"][0][0]==0) response2[\"values\"][0][0]=1;\n  if (response4[\"values\"][0][0]==0) response4[\"values\"][0][0]=1;\n  if (response6[\"values\"][0][0]==0) response6[\"values\"][0][0]=1;\n  if (response8[\"values\"][0][0]==0) response8[\"values\"][0][0]=1;\n  if (response10[\"values\"][0][0]==0) response10[\"values\"][0][0]=1;\n  if (response12[\"values\"][0][0]==0) response12[\"values\"][0][0]=1;\n  if (response14[\"values\"][0][0]==0) response14[\"values\"][0][0]=1;\n  if (response16[\"values\"][0][0]==0) response16[\"values\"][0][0]=1;\n  if (response18[\"values\"][0][0]==0) response18[\"values\"][0][0]=1;\n  if (response20[\"values\"][0][0]==0) response20[\"values\"][0][0]=1;\nreturn {\n    records: [\n     {\n        'Bucket': \"3s-4s\",\n        'CR': response1[\"values\"][0][0]/response2[\"values\"][0][0]*100\n},\n  {      'Bucket': \"4s-5s\",\n        'CR': response3[\"values\"][0][0]/response4[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"5s-6s\",\n        'CR': response5[\"values\"][0][0]/response6[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"6s-7s\",\n        'CR': response7[\"values\"][0][0]/response8[\"values\"][0][0]*100\n      },\n     {\n        'Bucket': \"7s-8s\",\n        'CR': response9[\"values\"][0][0]/response10[\"values\"][0][0]*100\n},\n  {      'Bucket': \"8s-9s\",\n        'CR': response11[\"values\"][0][0]/response12[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"9s-10s\",\n        'CR': response13[\"values\"][0][0]/response14[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"10s-11s\",\n        'CR': response15[\"values\"][0][0]/response16[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"11s-12s\",\n        'CR': response17[\"values\"][0][0]/response18[\"values\"][0][0]*100\n      },\n  {      'Bucket': \">12s\",\n        'CR': response19[\"values\"][0][0]/response20[\"values\"][0][0]*100\n      },\n],\n    types: [\n      {\n        indexRange: [0, 1],\n        mappings: {\n          'Bucket': { type: 'string' },\n          'CR': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","colorPalette":"apdex","legend":{"hidden":true},"categoricalBarChartSettings":{"categoryAxis":"Bucket","categoryAxisLabel":"Performance Grouping","valueAxis":"CR","valueAxisLabel":"Conversion Rate","scale":"absolute","min":null,"max":null}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Bucket"},"table":{"enableLineWrap":false,"lineWrapIds":[]},"histogram":{"dataMappings":[{"valueAxis":"CR","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"159":{"type":"code","title":"Site Exit Trend by \"$KeyUserAction\" Performance Increase","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n   const usqlQuery1 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>3000 and duration<=4000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery2 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>3000 and duration<=4000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery3 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>4000 and duration<=5000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery4 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>4000 and duration<=5000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery5 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>5000 and duration<=6000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery6 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>5000 and duration<=6000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery7 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>6000 and duration<=7000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery8 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>6000 and duration<=7000 and starttime>='+startTime+' and endtime<='+endTime;  \n  const usqlQuery9 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>7000 and duration<=8000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery10 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>7000 and duration<=8000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery11 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>8000 and duration<=9000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery12 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>8000 and duration<=9000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery13 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>9000 and duration<=10000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery14 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>9000 and duration<=10000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery15 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>10000 and duration<=11000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery16 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>10000 and duration<=11000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery17 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>11000 and duration<=12000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery18 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>11000 and duration<=12000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery19 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>12000 and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery20 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>12000 and starttime>='+startTime+' and endtime<='+endTime;\n  const response1 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery1,startTimestamp: startTime, endTimestamp: endTime });\n  const response2 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery2,startTimestamp: startTime, endTimestamp: endTime });\n  const response3 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery3,startTimestamp: startTime, endTimestamp: endTime });\n  const response4 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery4,startTimestamp: startTime, endTimestamp: endTime });\n  const response5 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery5,startTimestamp: startTime, endTimestamp: endTime });\n  const response6 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery6,startTimestamp: startTime, endTimestamp: endTime });\n  const response7 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery7,startTimestamp: startTime, endTimestamp: endTime });\n  const response8 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery8,startTimestamp: startTime, endTimestamp: endTime });\n  const response9 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery9,startTimestamp: startTime, endTimestamp: endTime });\n  const response10 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery10,startTimestamp: startTime, endTimestamp: endTime });\n  const response11 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery11,startTimestamp: startTime, endTimestamp: endTime });\n  const response12 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery12,startTimestamp: startTime, endTimestamp: endTime });\n  const response13 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery13,startTimestamp: startTime, endTimestamp: endTime });\n  const response14 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery14,startTimestamp: startTime, endTimestamp: endTime });\n  const response15 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery15,startTimestamp: startTime, endTimestamp: endTime });\n  const response16 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery16,startTimestamp: startTime, endTimestamp: endTime });\n  const response17 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery17,startTimestamp: startTime, endTimestamp: endTime });\n  const response18 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery18,startTimestamp: startTime, endTimestamp: endTime });\n  const response19 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery19,startTimestamp: startTime, endTimestamp: endTime });\n  const response20 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery20,startTimestamp: startTime, endTimestamp: endTime });\n  if (response2[\"values\"][0][0]==0) response2[\"values\"][0][0]=1;\n  if (response4[\"values\"][0][0]==0) response4[\"values\"][0][0]=1;\n  if (response6[\"values\"][0][0]==0) response6[\"values\"][0][0]=1;\n  if (response8[\"values\"][0][0]==0) response8[\"values\"][0][0]=1;\n  if (response10[\"values\"][0][0]==0) response10[\"values\"][0][0]=1;\n  if (response12[\"values\"][0][0]==0) response12[\"values\"][0][0]=1;\n  if (response14[\"values\"][0][0]==0) response14[\"values\"][0][0]=1;\n  if (response16[\"values\"][0][0]==0) response16[\"values\"][0][0]=1;\n  if (response18[\"values\"][0][0]==0) response18[\"values\"][0][0]=1;\n  if (response20[\"values\"][0][0]==0) response20[\"values\"][0][0]=1;\nreturn {\n    records: [\n     {\n        'Bucket': \"3s-4s\",\n        'CR': response1[\"values\"][0][0]/response2[\"values\"][0][0]*100\n},\n  {      'Bucket': \"4s-5s\",\n        'CR': response3[\"values\"][0][0]/response4[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"5s-6s\",\n        'CR': response5[\"values\"][0][0]/response6[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"6s-7s\",\n        'CR': response7[\"values\"][0][0]/response8[\"values\"][0][0]*100\n      },\n     {\n        'Bucket': \"7s-8s\",\n        'CR': response9[\"values\"][0][0]/response10[\"values\"][0][0]*100\n},\n  {      'Bucket': \"8s-9s\",\n        'CR': response11[\"values\"][0][0]/response12[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"9s-10s\",\n        'CR': response13[\"values\"][0][0]/response14[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"10s-11s\",\n        'CR': response15[\"values\"][0][0]/response16[\"values\"][0][0]*100\n      },\n  {      'Bucket': \"11s-12s\",\n        'CR': response17[\"values\"][0][0]/response18[\"values\"][0][0]*100\n      },\n  {      'Bucket': \">12s\",\n        'CR': response19[\"values\"][0][0]/response20[\"values\"][0][0]*100\n      },\n],\n    types: [\n      {\n        indexRange: [0, 2],\n        mappings: {\n          'Bucket': { type: 'string' },\n          'CR': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","colorPalette":"apdex","legend":{"hidden":true},"categoricalBarChartSettings":{"categoryAxis":"Bucket","categoryAxisLabel":"Performance Grouping","valueAxis":"CR","valueAxisLabel":"Exit Rate"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Bucket"},"table":{"enableLineWrap":false,"lineWrapIds":[]},"histogram":{"dataMappings":[{"valueAxis":"CR","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"160":{"type":"code","title":"Graph Analysis","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Get KPI for sessions that converted\n  const usqlQuery = 'SELECT avg(useraction.duration) FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringproperties.'+$ConversionGoal+' is not null and starttime>='+startTime+' and endtime<='+endTime;\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,startTimestamp: startTime, endTimestamp: endTime });\n  // Get Conversion Rate below and above KPI line\n  const usqlQuery1 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration<'+response[\"values\"][0][0]+' and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery2 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration<'+response[\"values\"][0][0]+' and starttime>='+startTime+' and endtime<='+endTime;\n  const response1 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery1,startTimestamp: startTime, endTimestamp: endTime });\n  const response2 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery2,startTimestamp: startTime, endTimestamp: endTime });\n  const usqlQuery3 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and usersession.stringProperties.'+$ConversionGoal+' is not null and duration>'+response[\"values\"][0][0]+' and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery4 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>'+response[\"values\"][0][0]+' and starttime>='+startTime+' and endtime<='+endTime;\n  const response3 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery3,startTimestamp: startTime, endTimestamp: endTime });\n  const response4 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery4,startTimestamp: startTime, endTimestamp: endTime });\n// Return analysis\n  if ((response1[\"values\"][0][0]/response2[\"values\"][0][0]*100)-(response3[\"values\"][0][0]/response4[\"values\"][0][0]*100)>10) \n     return \"ðŸ”´ \\\"\"+$KeyUserAction+\"\\\" Duration is significantly impacting your conversion rate.\";\n  else if ((response1[\"values\"][0][0]/response2[\"values\"][0][0]*100)-(response3[\"values\"][0][0]/response4[\"values\"][0][0]*100)>0)\n     return \"ðŸŸ¡ \\\"\"+$KeyUserAction+\"\\\" Duration is moderately impacting your conversion rate.\";\n  else \n     return \"ðŸŸ¢\\\"\"+$KeyUserAction+\"\\\" Duration is not impacting your conversion  rate.\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"Analysis Summary","autoscale":false,"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"161":{"type":"code","title":"Graph Analysis","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Get KPI for sessions that converted\n  const usqlQuery = 'SELECT avg(useraction.duration) FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and starttime>='+startTime+' and endtime<='+endTime;\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,startTimestamp: startTime, endTimestamp: endTime });\n  // Get Conversion Rate below and above KPI line\n  const usqlQuery1 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration<'+response[\"values\"][0][0]+' and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery2 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration<'+response[\"values\"][0][0]+' and starttime>='+startTime+' and endtime<='+endTime;\n  const response1 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery1,startTimestamp: startTime, endTimestamp: endTime });\n  const response2 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery2,startTimestamp: startTime, endTimestamp: endTime });\n  const usqlQuery3 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and isexitaction is true and duration>'+response[\"values\"][0][0]+' and starttime>='+startTime+' and endtime<='+endTime;\n  const usqlQuery4 = 'SELECT count(*) as \"CNT\" FROM useraction WHERE useraction.application=\"'+$AppName+'\" and name=\"'+$KeyUserAction+'\" and duration>'+response[\"values\"][0][0]+' and starttime>='+startTime+' and endtime<='+endTime;\n  const response3 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery3,startTimestamp: startTime, endTimestamp: endTime });\n  const response4 = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery4,startTimestamp: startTime, endTimestamp: endTime });\nconsole.log(\"Avg Duration\",response[\"values\"][0][0])\nconsole.log(\"Below Exits\",response1[\"values\"][0][0])\nconsole.log(\"Below Sessions\",response2[\"values\"][0][0])\nconsole.log(\"Above Exits\",response3[\"values\"][0][0])\nconsole.log(\"Above Sessions\",response4[\"values\"][0][0])\n  // Return analysis\n  if ((response3[\"values\"][0][0]/response4[\"values\"][0][0]*100)-(response1[\"values\"][0][0]/response2[\"values\"][0][0]*100)>10) \n     return \"ðŸ”´ \\\"\"+$KeyUserAction+\"\\\" is significantly causing users to exit your site.\";\n  else if ((response3[\"values\"][0][0]/response4[\"values\"][0][0]*100)-(response1[\"values\"][0][0]/response2[\"values\"][0][0]*100)>0)\n     return \"ðŸŸ¡ \\\"\"+$KeyUserAction+\"\\\" is moderately causing users to exit your site.\";\n  else \n     return \"ðŸŸ¢ \\\"\"+$KeyUserAction+\"\\\" is not causing users to exit your site.\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true,"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"162":{"title":"","type":"markdown","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"167":{"type":"markdown","title":"","content":"### \"$KeyUserAction\" Analysis"},"169":{"type":"code","title":"Avg Duration","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName.replace(/\"/g, \"\\\"\\\"\")+\"\\\"\";\n  const query = 'SELECT avg(duration) from useraction WHERE useraction.application in ('+appsList+') and starttime>='+startTime+' and endtime<='+endTime;\n  export default async function () {\n  const result = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: startTime, endTimestamp: endTime});\n  return (result[\"values\"][0][0])+0;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":">","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":">","label":"","value":3000},{"id":2,"color":"#F8312F","comparator":">","label":"","value":12000}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"170":{"type":"code","title":"Apdex","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName.replace(/\"/g, \"\\\"\\\"\")+\"\\\"\";\n  const query = 'SELECT CONDITION (count(*),WHERE apdexcategory=\"SATISFIED\"), CONDITION (count(*),WHERE apdexcategory=\"TOLERATING\"), CONDITION (count(*),WHERE apdexcategory=\"FRUSTRATED\") FROM useraction WHERE useraction.application in ('+appsList+') and starttime>='+startTime+' and endtime<='+endTime;\n  export default async function () {\n  const result = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: startTime, endTimestamp: endTime});\n  var apdex = ((result[\"values\"][0][0] + (result[\"values\"][0][1]/2))/(result[\"values\"][0][0] + result[\"values\"][0][1] + result[\"values\"][0][2]));\n  return apdex;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":">","label":"","value":0.92},{"id":1,"color":"#FCD53F","comparator":">","label":"","value":0.8},{"id":2,"color":"#F8312F","comparator":">","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"171":{"type":"code","title":"Conversion Rate","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName.replace(/\"/g, \"\\\"\\\"\")+\"\\\"\";\n  const query = 'SELECT count(*) as \"Sessions\" FROM useraction WHERE useraction.application in ('+appsList+') and useraction.isexitaction is true and starttime>='+startTime+' and endtime<='+endTime;\n  const query1 = 'SELECT count(*) as \"Conversions\" FROM useraction WHERE useraction.application in ('+appsList+') and usersession.stringProperties.'+$ConversionGoal+' is not null and useraction.isexitaction is true and starttime>='+startTime+' and endtime<='+endTime;\n  export default async function () {\n  const result = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: startTime, endTimestamp: endTime});\n  const result1 = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: startTime, endTimestamp: endTime});\n  return (result1[\"values\"][0][0]/result[\"values\"][0][0]*100);\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":">","label":"","value":24},{"id":1,"color":"#FCD53F","comparator":">","label":"","value":20},{"id":2,"color":"#F8312F","comparator":">","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"172":{"type":"code","title":"Projected Conversion Rate","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\" + $AppName.replace(/\"/g, \"\\\"\\\"\") + \"\\\"\";\n  var usqlQuery = 'select distinct name as \"User Actions\",count(*) as \"Requests\", CONDITION(COUNT(*), WHERE isExitAction=true) as \"Exits\" from useraction where application in (' + appsList + ') and starttime>=' + startTime + ' and endtime<=' + endTime + ' order by Requests DESC limit 500';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  const sampleCount = response.values.length;\n  const query2 = 'SELECT count(*) as \"Sessions\" FROM useraction WHERE useraction.application in ('+appsList+') and useraction.isexitaction is true and starttime>='+startTime+' and endtime<='+endTime;\n  const query3 = 'SELECT count(*) as \"Conversions\" FROM useraction WHERE useraction.application in ('+appsList+') and usersession.stringProperties.'+$ConversionGoal+' is not null and useraction.isexitaction is true and starttime>='+startTime+' and endtime<='+endTime;\n  const result2 = await rumUserSessionsClient.getUsqlResultAsTable({query: query2, startTimestamp: startTime, endTimestamp: endTime});\n  const result3 = await rumUserSessionsClient.getUsqlResultAsTable({query: query3, startTimestamp: startTime, endTimestamp: endTime});\n  var sumRiskAbandons = 0;\n  for (var i = 0; i < sampleCount; i++) {\n    var actionName = response.values[i][0].replace(/\"/g, \"\\\"\\\"\");\n    var query1 = 'SELECT count(distinct usersession.usersessionid) FROM useraction WHERE application in (' + appsList + ') and name=\"' + actionName + '\" and usersession.stringproperties.' + $ConversionGoal + ' is null and useraction.duration>(1000*' + $kpiLimit + ') and isexitaction is true and starttime>=' + startTime + ' and endtime<=' + endTime;\n    const result1 = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: startTime, endTimestamp: endTime});\n    sumRiskAbandons = sumRiskAbandons+result1[\"values\"][0][0];\n  }\n  return (((result3[\"values\"][0][0]/result2[\"values\"][0][0]*sumRiskAbandons)+result3[\"values\"][0][0])/result2[\"values\"][0][0])*100;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":">","label":"","value":24},{"id":1,"color":"#FCD53F","comparator":">","label":"","value":20},{"id":2,"color":"#F8312F","comparator":">","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"173":{"type":"code","title":"Projected Annualized Gain","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\" + $AppName.replace(/\"/g, \"\\\"\\\"\") + \"\\\"\";\n  var usqlQuery = 'select distinct name as \"User Actions\",count(*) as \"Requests\", CONDITION(COUNT(*), WHERE isExitAction=true) as \"Exits\" from useraction where application in (' + appsList + ') and starttime>=' + startTime + ' and endtime<=' + endTime + ' order by Requests DESC limit 500';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  const sampleCount = response.values.length;\n  const query2 = 'SELECT count(*) as \"Sessions\" FROM useraction WHERE useraction.application in ('+appsList+') and useraction.isexitaction is true and starttime>='+startTime+' and endtime<='+endTime;\n  const query3 = 'SELECT count(*) as \"Conversions\" FROM useraction WHERE useraction.application in ('+appsList+') and usersession.stringProperties.'+$ConversionGoal+' is not null and useraction.isexitaction is true and starttime>='+startTime+' and endtime<='+endTime;\n  const result2 = await rumUserSessionsClient.getUsqlResultAsTable({query: query2, startTimestamp: startTime, endTimestamp: endTime});\n  const result3 = await rumUserSessionsClient.getUsqlResultAsTable({query: query3, startTimestamp: startTime, endTimestamp: endTime});\n  var sumRiskAbandons = 0;\n  for (var i = 0; i < sampleCount; i++) {\n    var actionName = response.values[i][0].replace(/\"/g, \"\\\"\\\"\");\n    var query1 = 'SELECT count(distinct usersession.usersessionid) FROM useraction WHERE application in (' + appsList + ') and name=\"' + actionName + '\" and usersession.stringproperties.' + $ConversionGoal + ' is null and useraction.duration>(1000*' + $kpiLimit + ') and isexitaction is true and starttime>=' + startTime + ' and endtime<=' + endTime;\n    const result1 = await rumUserSessionsClient.getUsqlResultAsTable({query: query1, startTimestamp: startTime, endTimestamp: endTime});\n    sumRiskAbandons = sumRiskAbandons+result1[\"values\"][0][0];\n  }\n  return ((result3[\"values\"][0][0]/result2[\"values\"][0][0])*sumRiskAbandons)*$AvgOrderValue*365/((endTime - startTime)/24/60/60/1000);\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":">","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"currency","baseUnit":"usd","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"174":{"type":"code","title":"Conversion and Abandon Duration for \"$KeyUserAction\"","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"1m\"\n  if (timeDiff>.5)\n    var chartInterval = \"10m\"\n  if (timeDiff>1)\n    var chartInterval = \"1h\"\n  const usqlQuery = 'SELECT DATETIME(usersession.endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", CONDITION(avg(useraction.duration), where usersession.stringProperties.'+$ConversionGoal+' is not null)  AS \"Conversions\", CONDITION(avg(useraction.duration), where usersession.stringProperties.'+$ConversionGoal+' is null)  AS \"Abandons\" from useraction WHERE useraction.application=\"'+$AppName+'\" and useraction.name=\"'+$KeyUserAction+'\" and  usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' GROUP BY  DATETIME(usersession.endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  const sampleCount = response.values.length;\n  return {\n    records: new Array(sampleCount).fill(null).map((_, index, array) => {\n      return {\n        Date: response.values[index][0],\n        'Conversions': response.values[index][1]/1000,\n        'Abandons': response.values[index][2]/1000\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n         Date: { type: 'timestamp' },\n          'Conversions': { type: 'double' },\n          'Abandons': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"seriesOverrides":[{"seriesId":["Abandons"],"override":{"color":{"Default":"var(--dt-colors-charts-security-risk-level-critical-default, #8a0012)"}}},{"seriesId":["Conversions"],"override":{"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #0d9c29)","Hover":"var(--dt-colors-charts-categorical-color-09-hover, #0a7b20)","Active":"var(--dt-colors-charts-categorical-color-09-active, #075f19)","DefaultTransparent":"var(--dt-colors-charts-categorical-color-09-default-transparent, #008500cc)","HoverTransparent":"var(--dt-colors-charts-categorical-color-09-hover-transparent, #005905cc)","ActiveTransparent":"var(--dt-colors-charts-categorical-color-09-active-transparent, #003112cc)"}}}],"legend":{"position":"bottom","hidden":false},"leftYAxisSettings":{"label":"Seconds"},"fieldMapping":{"timestamp":"Date","leftAxisValues":["Conversions","Abandons"],"leftAxisDimensions":[],"fields":[],"values":[],"rightAxisValues":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Date"},"table":{"rowDensity":"condensed","enableLineWrap":false,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[{"valueAxis":"Conversions","rangeAxis":""},{"valueAxis":"Abandons","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"175":{"type":"markdown","title":"","content":"# \n# ðŸ”Ž Performance Conversion Analysis"}},"layouts":{"8":{"x":0,"y":0,"w":24,"h":1},"36":{"x":0,"y":40,"w":22,"h":1},"76":{"x":22,"y":40,"w":2,"h":1},"144":{"x":0,"y":3,"w":24,"h":1},"148":{"x":0,"y":11,"w":24,"h":1},"149":{"x":0,"y":5,"w":24,"h":6},"150":{"x":0,"y":13,"w":8,"h":6},"151":{"x":8,"y":13,"w":8,"h":6},"152":{"x":16,"y":13,"w":8,"h":6},"153":{"x":0,"y":12,"w":23,"h":1},"154":{"x":0,"y":4,"w":23,"h":1},"156":{"x":11,"y":1,"w":2,"h":2},"157":{"x":9,"y":1,"w":2,"h":2},"158":{"x":0,"y":21,"w":12,"h":7},"159":{"x":12,"y":21,"w":12,"h":7},"160":{"x":0,"y":28,"w":12,"h":2},"161":{"x":12,"y":28,"w":12,"h":2},"162":{"x":0,"y":19,"w":24,"h":1},"167":{"x":0,"y":20,"w":23,"h":1},"169":{"x":13,"y":1,"w":2,"h":2},"170":{"x":15,"y":1,"w":2,"h":2},"171":{"x":17,"y":1,"w":2,"h":2},"172":{"x":19,"y":1,"w":2,"h":2},"173":{"x":21,"y":1,"w":3,"h":2},"174":{"x":0,"y":30,"w":24,"h":10},"175":{"x":0,"y":1,"w":9,"h":2}}}