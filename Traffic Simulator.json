{"version":13,"variables":[{"key":"AppName","type":"code","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n const lastXDays = 1;\n const usqlQuery = 'SELECT DISTINCT application FROM useraction';\n const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n const sampleCount = response.values.length;\n function flatten(arr) {\n    var flat = [];\n    for (var i = 0; i < sampleCount; i++) {\n        flat = flat.concat(arr[i]);\n    }\n    return flat;\n}\n return( flatten(response.values))\n}","multiple":true},{"key":"TrafficChangePercent","type":"csv","input":"5,10,20,25,50,100,150,200,250,300,350,400,450,500","multiple":false},{"key":"ActionCategory","type":"csv","input":"All,Key,Entry,Exit","multiple":false},{"key":"LocationFilter","type":"csv","input":"Country,Continent,Region,City","multiple":false},{"key":"EnvironmentFilter","type":"csv","input":"browserFamily,browserMajorVersion,ISP,osFamily,osVersion","multiple":false},{"key":"KPI","type":"csv","input":"Duration,VisuallyCompleteTime,SpeedIndex,LoadEventEnd,FirstInputDelay,CumulativeLayoutShift,LargestContentfulPaint,CdnBusyTime,CdnResources,DocumentInteractiveTime,DomCompleteTime,DomContentLoadedTime,FirstPartyBusyTime,FirstPartyResources,FrontendTime,LoadEventStart,NavigationStart,NetworkTime,RequestStart,ResponseEnd,ResponseStart,ServerTime,ThirdPartyBusyTime,ThirdPartyResources","multiple":false},{"key":"ActionType","type":"csv","input":"Load, Xhr","multiple":true}],"tiles":{"2":{"type":"code","title":"$KPI Impact (ms)","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricName = \"Avg \"+$KPI;\n  const metricAgg = \"avg\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + (metricAVG/sampleCount)*((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent/100)\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n  return metricName+\" is \"+Number(metricAVG/sampleCount).toFixed(2)+\". Predicted \"+metricName+\" is \"+(predictedMetric).toFixed(2)+\" modeled with a \"+$TrafficChangePercent+\"% traffic increase.\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"Diff","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"5":{"type":"code","title":"$KPI Change","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricName = \"Avg Duration\";\n  const metricAgg = \"avg\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime, offsetUTC: -300});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n  return ($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric+0;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¤","label":"","value":-3},{"id":1,"color":"#FCD53F","comparator":">","label":"","value":-3},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":3}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":"percent","decimals":2,"suffix":"%","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"7":{"type":"code","title":"$KPI Distribution Below/Above Traffic Average","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricName = \"Avg Duration\";\n  const metricAgg = \"avg\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\nreturn {\n    records: [\n     {\n        'Traffic': \"Below Average\",\n        'Duration': (metricBAVG/i2B)\n      },\n    {   'Traffic': \"Average\",\n        'Duration': (metricAVG/sampleCount)\n      },\n    {   'Traffic': \"Above Average\",\n        'Duration': (metricAAVG/i2A)\n      },\n],\n    types: [\n      {\n        indexRange: [0, 2],\n        mappings: {\n          'Traffic': { type: 'string' },\n          'Duration': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[{"id":1,"field":"","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"â‰¥","label":""},{"id":1,"color":{"Default":"var(--dt-colors-charts-categorical-color-14-default, #d56b1a)"},"comparator":"â‰¥","label":""},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":"â‰¥","label":""}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{"Below Average":{"color":"#00D26A","added":1701452595143},"Average":{"color":"#FCD53F","added":1701452607415},"Above Average":{"color":"#F8312F","added":1701452636972}},"legend":{"hidden":true},"categoricalBarChartSettings":{"categoryAxis":"Traffic","categoryAxisLabel":"Traffic","valueAxis":"Duration","valueAxisLabel":"Duration"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"Traffic"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"Diff","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"Duration","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"10":{"type":"code","title":"$KPI Health","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricName = \"Avg Duration\";\n  const metricAgg = \"avg\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n  if (($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric>3) return \"ðŸ”´\";\n  if (($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric<-3) return \"ðŸŸ¢\";\n  return \"ðŸŸ¡\"\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"Diff","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"11":{"type":"markdown","title":"","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"12":{"type":"markdown","title":"","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"14":{"type":"markdown","title":"","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"15":{"type":"markdown","title":"","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"17":{"type":"code","title":"Request Error Health","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"requestErrorCount\";\n  const metricName = \"Error Count\";\n  const metricAgg = \"sum\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n  if (($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric>3) return \"ðŸ”´\";\n  if (($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric<-3) return \"ðŸŸ¢\";\n  return \"ðŸŸ¡\"\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"Diff","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"18":{"type":"code","title":"Request Error Impact","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"requestErrorCount\";\n  const metricName = \"Error Average\";\n  const metricAgg = \"sum\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + (metricAVG/sampleCount)*((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent/100)\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n  return metricName+\" is \"+Number(metricAVG/sampleCount).toFixed(2)+\". Predicted \"+metricName+\" is \"+(predictedMetric).toFixed(2)+\" modeled with a \"+$TrafficChangePercent+\"% traffic increase.\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"Diff","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"20":{"type":"code","title":"JavaScript Error Impact","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"javascriptErrorCount\";\n  const metricName = \"Error Average\";\n  const metricAgg = \"sum\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + (metricAVG/sampleCount)*((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent/100)\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n  return metricName+\" is \"+Number(metricAVG/sampleCount).toFixed(2)+\". Predicted \"+metricName+\" is \"+(predictedMetric).toFixed(2)+\" modeled with a \"+$TrafficChangePercent+\"% traffic increase.\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"Diff","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"21":{"type":"code","title":"JavaScript Error Health","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"javascriptErrorCount\";\n  const metricName = \"Error Count\";\n  const metricAgg = \"sum\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n  if (($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric>3) return \"ðŸ”´\";\n  if (($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric<-3) return \"ðŸŸ¢\";\n  return \"ðŸŸ¡\"\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"Diff","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"22":{"type":"code","title":"Overall Health","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  var metric = $KPI;\n  const metricAgg = \"avg\";\n  var condition = \"\";\n  var chartInterval = \"1m\";\n  var healthCount = 0;\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  var i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Duration Health\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  var response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  var sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n  if (($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric>3) healthCount=healthCount+1;\n  if (($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric>-3) healthCount=healthCount+1;\n  // End Duration Health\n  // Request Health\n  metric=\"requesterrorcount\";\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", sum('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", sum('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", sum('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", sum('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<24) return \"Try increasing the timeframe.\";\n  // Toss last 30 minutes\n  sampleCount = response.values.length-6;\n  percentChangeMetric = 0;\n  percentChangeTraffic = 0;\n  trafficAVG = 0;\n  metricAVG = 0;\n  metricAAVG = 0;\n  metricBAVG = 0;\n  trafficAAVG = 0; \n  trafficBAVG = 0;\n  c = 0;\n  // Get traffic volume and summarize metric\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    c++;\n  }\n  i2 = 0;\n  i2A = 0;\n  i2B = 0;\n  // Bucket metric results (5 minute interval) into above/below traffic average\n  while (i2 < sampleCount) {\n    if (response.values[i2][1]>(trafficAVG/sampleCount))\n      {\n        metricAAVG=metricAAVG+response.values[i2][2];\n        trafficAAVG=trafficAAVG+response.values[i2][1];\n        i2A++;\n      }\n    if (response.values[i2][1]<(trafficAVG/sampleCount)) \n      {\n        metricBAVG=metricBAVG+response.values[i2][2];\n        trafficBAVG=trafficBAVG+response.values[i2][1];\n        i2B++;\n      }\n    i2++;\n  }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  if ((percentChangeMetric+((percentChangeMetric*$TrafficChangePercent/100)))>3) healthCount=healthCount+2;\n  if ((percentChangeMetric+((percentChangeMetric*$TrafficChangePercent/100)))>0) healthCount=healthCount+1;\n  // End Request Health\n  // JS Health\n  metric=\"javascripterrorcount\";\n  usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", sum('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", sum('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", sum('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", sum('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<24) return \"Try increasing the timeframe.\";\n  // Toss last 30 minutes\n  sampleCount = response.values.length-6;\n  percentChangeMetric = 0;\n  percentChangeTraffic = 0;\n  trafficAVG = 0;\n  metricAVG = 0;\n  metricAAVG = 0;\n  metricBAVG = 0;\n  trafficAAVG = 0;\n  trafficBAVG = 0;\n  c = 0;\n  // Get traffic volume and summarize metric\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    c++;\n  }\n  i2 = 0;\n  i2A = 0;\n  i2B = 0;\n  // Bucket metric results (5 minute interval) into above/below traffic average\n  while (i2 < sampleCount) {\n    if (response.values[i2][1]>(trafficAVG/sampleCount))\n      {\n        metricAAVG=metricAAVG+response.values[i2][2];\n        trafficAAVG=trafficAAVG+response.values[i2][1];\n        i2A++;\n      }\n    if (response.values[i2][1]<(trafficAVG/sampleCount)) \n      {\n        metricBAVG=metricBAVG+response.values[i2][2];\n        trafficBAVG=trafficBAVG+response.values[i2][1];\n        i2B++;\n      }\n    i2++;\n  }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  if ((percentChangeMetric+((percentChangeMetric*$TrafficChangePercent/100)))>3) healthCount=healthCount+2;\n  if ((percentChangeMetric+((percentChangeMetric*$TrafficChangePercent/100)))>0) healthCount=healthCount+1;\n  // End JS Health\n  //  return health status icon\n  if (healthCount>1) return \"ðŸ”´\";\n  if (healthCount>0) return \"ðŸŸ¡\";\n  return \"ðŸŸ¢\"\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"Diff","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"24":{"type":"code","title":"Request Error Rate Distribution Below/Above Traffic Average","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"requestErrorCount\";\n  const metricName = \"Error Count\";\n  const metricAgg = \"sum\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\nreturn {\n    records: [\n     {\n        'Traffic': \"Below Average\",\n        'Errors': metricBAVG/i2B\n      },\n    {   'Traffic': \"Average\",\n        'Errors': metricAVG/sampleCount\n      },\n    {   'Traffic': \"Above Average\",\n        'Errors': metricAAVG/i2A\n      },\n],\n    types: [\n      {\n        indexRange: [0, 2],\n        mappings: {\n          'Traffic': { type: 'string' },\n          'Errors': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{"Below Average":{"color":"#00D26A","added":1702149388683},"Above Average":{"color":"#F8312F","added":1702149391362},"Average":{"color":"#FCD53F","added":1702149394566}},"categoricalBarChartSettings":{"categoryAxis":"Traffic","categoryAxisLabel":"Traffic","valueAxis":"Errors","valueAxisLabel":"Errors"},"legend":{"hidden":true}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"Traffic"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"Errors","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"25":{"type":"code","title":"JavaScript Error Rate Distribution Below/Above Traffic Average","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"javascriptErrorCount\";\n  const metricName = \"Error Count\";\n  const metricAgg = \"sum\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\nreturn {\n    records: [\n     {\n        'Traffic': \"Below Average\",\n        'Errors': metricBAVG/i2B\n      },\n    {   'Traffic': \"Average\",\n        'Errors': metricAVG/sampleCount\n      },\n    {   'Traffic': \"Above Average\",\n        'Errors': metricAAVG/i2A\n      },\n],\n    types: [\n      {\n        indexRange: [0, 2],\n        mappings: {\n          'Traffic': { type: 'string' },\n          'Errors': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{"Below Average":{"color":"#00D26A","added":1702149388683},"Above Average":{"color":"#F8312F","added":1702149391362},"Average":{"color":"#FCD53F","added":1702149394566}},"categoricalBarChartSettings":{"categoryAxis":"Traffic","categoryAxisLabel":"Traffic","valueAxis":"Errors","valueAxisLabel":"Errors"},"legend":{"hidden":true}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"Traffic"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"Errors","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"32":{"type":"markdown","title":"","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"35":{"type":"code","title":"Traffic Impact on User Action $KPI","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricName = \"Avg Duration\";\n  const metricAgg = \"avg\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Get useraction names\n  var usqlQueryActions = 'SELECT DISTINCT name,'+metricAgg+'('+metric+') as D1,count(*),min('+metric+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' order by count(*) DESC limit 1000';\n  if ($ActionCategory==\"Key\") usqlQueryActions = 'SELECT DISTINCT name,'+metricAgg+'('+metric+'),count(*),min('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 1000';\n  if ($ActionCategory==\"Entry\") usqlQueryActions = 'SELECT DISTINCT name,'+metricAgg+'('+metric+'),count(*),min('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 1000';\n  if ($ActionCategory==\"Exit\") usqlQueryActions = 'SELECT DISTINCT name,'+metricAgg+'('+metric+'),count(*),min('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 1000';\n  const responseActions = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQueryActions, startTimestamp: startTime, endTimestamp: endTime});\n  // Loop thru each useraction\n  for (var actions = 0; actions < responseActions.values.length; actions++) {\n        responseActions.values[actions][0] = responseActions.values[actions][0].replace(/\"/g, \"\\\"\\\"\");\n        // Get traffic and metric details\n        var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION ('+metricAgg+'('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n        if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION ('+metricAgg+'('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n        if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION ('+metricAgg+'('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n        if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION ('+metricAgg+'('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n        var response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n        // Toss last 30 minutes\n        var sampleCount = response.values.length-6;\n\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n\n    responseActions.values[actions][1]=metricAVG/sampleCount;    \n    responseActions.values[actions][4]=predictedMetric;\n    }\n  \n    return {\n    records: new Array(responseActions.values.length).fill(null).map((_, index, array) => {\n      return {\n        'User Action': responseActions.values[index][0],\n        'Count': responseActions.values[index][2],\n        'Performance': responseActions.values[index][1].toFixed(2)+0,\n        'Prediction': responseActions.values[index][4]+0,\n        'Change': (responseActions.values[index][4]-responseActions.values[index][1]).toFixed(2)+0,\n        'Impact': ((responseActions.values[index][4]-responseActions.values[index][1])*responseActions.values[index][2]).toFixed(2)+0\n\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n          'User Action': { type: 'string' },\n          'Count': { type: 'double' },\n          'Performance': { type: 'double' },\n          'Prediction': { type: 'double' },\n          'Change': { type: 'double' },\n          'Impact': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Performance","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":3000},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":6000}]},{"id":2,"field":"Prediction","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":3000},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":6000}]},{"id":3,"field":"Change","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":-99999999999},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":2000}]},{"id":4,"field":"Impact","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":-99999999999},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":200000}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"User Action","categoryAxisLabel":"User Action","valueAxis":"Count","valueAxisLabel":"Count"}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"User Action"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"User Action\"]":201,"[\"Count\"]":102.48124694824219,"[\"Duration\"]":114.01249694824219,"[\"Prediction\"]":126.66874694824219,"[\"Change\"]":141.73749542236328,"[\"Impact\"]":93.74999237060547},"sortBy":{"columnId":"[\"Impact\"]","direction":"descending"}},"unitsOverrides":[{"identifier":"Prediction","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734},{"identifier":"Performance","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583008650},{"identifier":"Change","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583201091},{"identifier":"Count","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1704909346634},{"identifier":"Impact","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1705510501558}],"histogram":{"dataMappings":[{"valueAxis":"Count","rangeAxis":""},{"valueAxis":"Performance","rangeAxis":""},{"valueAxis":"Prediction","rangeAxis":""},{"valueAxis":"Change","rangeAxis":""},{"valueAxis":"Impact","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"36":{"type":"code","title":"Traffic Impact on $LocationFilter $KPI","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricName = \"Avg Duration\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Get locations\n  var usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',avg('+metric+') as D1,count(*),min('+metric+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null order by count(*) DESC limit 500';\n  if ($ActionCategory==\"Key\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',avg('+metric+') as D1,count(*),min('+metric+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null and keyuseraction is true order by count(*) DESC limit 500';\n  if ($ActionCategory==\"Entry\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',avg('+metric+') as D1,count(*),min('+metric+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null and isentryaction is true order by count(*) DESC limit 500';\n  if ($ActionCategory==\"Exit\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',avg('+metric+') as D1,count(*),min('+metric+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null and isexitaction is true order by count(*) DESC limit 500';\n  const responseActions = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQueryActions, startTimestamp: startTime, endTimestamp: endTime});\n  // Loop thru each useraction\n  for (var actions = 0; actions < responseActions.values.length; actions++) {\n        responseActions.values[actions][0] = responseActions.values[actions][0].replace(/\"/g, \"\\\"\\\"\");\n        // Get traffic and metric details\n        var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (avg('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n        if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (avg('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n        if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (avg('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n        if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (avg('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n        var response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n        // Toss last 30 minutes\n        var sampleCount = response.values.length-6;\n\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n/*  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)*/\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n\n    responseActions.values[actions][1]=metricAVG/sampleCount;\n    responseActions.values[actions][4]=predictedMetric;\n    }\n  \n    return {\n    records: new Array(responseActions.values.length).fill(null).map((_, index, array) => {\n      return {\n        'Location': responseActions.values[index][0],\n        'Count': responseActions.values[index][2],\n        'Performance': responseActions.values[index][1].toFixed(2)+0,\n        'Prediction': responseActions.values[index][4]+0,\n        'Change': (responseActions.values[index][4]-responseActions.values[index][1]).toFixed(2)+0,\n        'Impact': ((responseActions.values[index][4]-responseActions.values[index][1])*responseActions.values[index][2]).toFixed(2)+0\n\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n          'Location': { type: 'string' },\n          'Count': { type: 'double' },\n          'Performance': { type: 'double' },\n          'Prediction': { type: 'double' },\n          'Change': { type: 'double' },\n          'Impact': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Performance","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":3000},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":6000}]},{"id":2,"field":"Prediction","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":3000},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":6000}]},{"id":3,"field":"Change","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":-99999999999},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":2000}]},{"id":4,"field":"Impact","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":-99999999999},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":200000}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"Location","categoryAxisLabel":"Location","valueAxis":"Count","valueAxisLabel":"Count"}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"Location"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{},"sortBy":{"columnId":"[\"Impact\"]","direction":"descending"}},"unitsOverrides":[{"identifier":"Prediction","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734},{"identifier":"Performance","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583008650},{"identifier":"Change","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583201091},{"identifier":"Count","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1704909346634},{"identifier":"Impact","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1705509269149}],"histogram":{"dataMappings":[{"valueAxis":"Count","rangeAxis":""},{"valueAxis":"Performance","rangeAxis":""},{"valueAxis":"Prediction","rangeAxis":""},{"valueAxis":"Change","rangeAxis":""},{"valueAxis":"Impact","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"37":{"type":"code","title":"Traffic Impact on $EnvironmentFilter $KPI","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricName = \"Avg Duration\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Get env data\n  var usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',avg('+metric+') as D1,count(*),min('+metric+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null order by count(*) DESC limit 500';\n  if ($ActionCategory==\"Key\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',avg('+metric+') as D1,count(*),min('+metric+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null and keyuseraction is true order by count(*) DESC limit 500';\n  if ($ActionCategory==\"Entry\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',avg('+metric+') as D1,count(*),min('+metric+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null and isentryaction is true order by count(*) DESC limit 500';\n  if ($ActionCategory==\"Exit\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',avg('+metric+') as D1,count(*),min('+metric+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null and isexitaction is true order by count(*) DESC limit 500';\n  const responseActions = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQueryActions, startTimestamp: startTime, endTimestamp: endTime});\n  // Loop thru each useraction\n  for (var actions = 0; actions < responseActions.values.length; actions++) {\n        responseActions.values[actions][0] = responseActions.values[actions][0].replace(/\"/g, \"\\\"\\\"\");\n        // Get traffic and metric details\n        var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (avg('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n        if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (avg('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n        if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (avg('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n        if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (avg('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n        var response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n        // Toss last 30 minutes\n        var sampleCount = response.values.length-6;\n\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n\n    responseActions.values[actions][1]=metricAVG/sampleCount;\n    responseActions.values[actions][4]=predictedMetric;\n    }\n  \n    return {\n    records: new Array(responseActions.values.length).fill(null).map((_, index, array) => {\n      return {\n        'Environment': responseActions.values[index][0],\n        'Count': responseActions.values[index][2],\n        'Performance': responseActions.values[index][1].toFixed(2)+0,\n        'Prediction': responseActions.values[index][4]+0,\n        'Change': (responseActions.values[index][4]-responseActions.values[index][1]).toFixed(2)+0,\n        'Impact': ((responseActions.values[index][4]-responseActions.values[index][1])*responseActions.values[index][2]).toFixed(2)+0\n\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n          'Environment': { type: 'string' },\n          'Count': { type: 'double' },\n          'Performance': { type: 'double' },\n          'Prediction': { type: 'double' },\n          'Change': { type: 'double' },\n          'Impact': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Performance","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":3000},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":6000}]},{"id":2,"field":"Prediction","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":3000},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":6000}]},{"id":3,"field":"Change","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":-99999999999},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":2000}]},{"id":4,"field":"Impact","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":-99999999999},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":200000}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"Environment","categoryAxisLabel":"Environment","valueAxis":"Count","valueAxisLabel":"Count"}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"Environment"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{},"sortBy":{"columnId":"[\"Impact\"]","direction":"descending"}},"unitsOverrides":[{"identifier":"Prediction","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734},{"identifier":"Performance","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583008650},{"identifier":"Change","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583201091},{"identifier":"Count","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1704909346634},{"identifier":"Impact","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1705509269149}],"histogram":{"dataMappings":[{"valueAxis":"Count","rangeAxis":""},{"valueAxis":"Performance","rangeAxis":""},{"valueAxis":"Prediction","rangeAxis":""},{"valueAxis":"Change","rangeAxis":""},{"valueAxis":"Impact","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"39":{"type":"code","title":"Traffic Impact on $EnvironmentFilter Request Errors","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"requestErrorCount\";\n  const metricName = \"Error Rate\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Get Locations\n  var usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null order by D1 DESC limit 100';\n  if ($ActionCategory==\"Key\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null and keyuseraction is true limit 100';\n  if ($ActionCategory==\"Entry\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null and isentryaction is true  limit 100';\n  if ($ActionCategory==\"Exit\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null and isexitaction is true limit 100';\n  const responseActions = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQueryActions, startTimestamp: startTime, endTimestamp: endTime});\n  // Loop thru each Location\n  for (var actions = 0; actions < responseActions.values.length; actions++) {\n        responseActions.values[actions][0] = responseActions.values[actions][0].replace(/\"/g, \"\\\"\\\"\");\n        // Get traffic and metric details\n        var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n        if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n        if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n        if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n        var response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n        // Toss last 30 minutes\n        var sampleCount = response.values.length-6;\n        let percentChangeMetric = 0;\n        let percentChangeTraffic = 0;\n        let trafficAVG = 0;\n        let metricAVG = 0;\n        let metricMIN = response.values[0][2];\n        let metricAAVG = 0;\n        let metricBAVG = 0;\n        let trafficAAVG = 0;\n        let trafficBAVG = 0;\n        let c = 0;\n        while (c < sampleCount) {\n          trafficAVG = trafficAVG + response.values[c][1];\n          metricAVG = metricAVG + response.values[c][2];\n          if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n          c++;\n        }\n        let i2 = 0;\n        let i2A = 0;\n        let i2B = 0;\n          while (i2 < sampleCount) {\n                if (response.values[i2][1]>(trafficAVG/sampleCount))\n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricAAVG=metricAAVG+response.values[i2][2];\n                    trafficAAVG=trafficAAVG+response.values[i2][1];\n                    i2A++;\n                        }\n                  }\n                if (response.values[i2][1]<(trafficAVG/sampleCount)) \n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricBAVG=metricBAVG+response.values[i2][2];\n                    trafficBAVG=trafficBAVG+response.values[i2][1];\n                    i2B++;\n                        }\n                  }\n                i2++;\n              }\n        if (metricBAVG==0) metricBAVG=1;\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n        if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n        responseActions.values[actions][1]=metricAVG;\n        responseActions.values[actions][2]=predictedMetric;\n    }\n  \n    return {\n    records: new Array(responseActions.values.length).fill(null).map((_, index, array) => {\n      return {\n        'Environment': responseActions.values[index][0],\n        'Errors': responseActions.values[index][1],\n        'Prediction': responseActions.values[index][2],\n        'Change': responseActions.values[index][2]-responseActions.values[index][1]\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n          'Environment': { type: 'string' },\n          'Errors': { type: 'double' },\n          'Prediction': { type: 'double' },\n          'Change': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Errors","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.5},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":1}]},{"id":2,"field":"Prediction","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.5},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":1}]},{"id":3,"field":"Change","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":-99999999},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.05},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":0.1}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"Environment","categoryAxisLabel":"Environment","valueAxis":"Errors","valueAxisLabel":"Errors"}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"Environment"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"User Action\"]":272.84375,"[\"Errors\"]":87.875,"[\"Prediction\"]":112.734375,"[\"Change\"]":95.796875},"sortBy":{"columnId":"[\"Change\"]","direction":"descending"}},"unitsOverrides":[{"identifier":"Prediction","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734},{"identifier":"Errors","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1704583008650},{"identifier":"Change","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583201091}],"histogram":{"dataMappings":[{"valueAxis":"Errors","rangeAxis":""},{"valueAxis":"Prediction","rangeAxis":""},{"valueAxis":"Change","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"40":{"type":"code","title":"Traffic Impact on $LocationFilter JavaScript Error Rate","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"javascriptErrorCount\";\n  const metricName = \"Error Rate\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Get Locations\n  var usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null order by D1 DESC limit 100';\n  if ($ActionCategory==\"Key\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null and keyuseraction is true limit 100';\n  if ($ActionCategory==\"Entry\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null and isentryaction is true  limit 100';\n  if ($ActionCategory==\"Exit\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null and isexitaction is true limit 100';\n  const responseActions = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQueryActions, startTimestamp: startTime, endTimestamp: endTime});\n  // Loop thru each Location\n  for (var actions = 0; actions < responseActions.values.length; actions++) {\n        responseActions.values[actions][0] = responseActions.values[actions][0].replace(/\"/g, \"\\\"\\\"\");\n        // Get traffic and metric details\n        var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n        if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n        if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n        if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n        var response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n        // Toss last 30 minutes\n        var sampleCount = response.values.length-6;\n        let percentChangeMetric = 0;\n        let percentChangeTraffic = 0;\n        let trafficAVG = 0;\n        let metricAVG = 0;\n        let metricMIN = response.values[0][2];\n        let metricAAVG = 0;\n        let metricBAVG = 0;\n        let trafficAAVG = 0;\n        let trafficBAVG = 0;\n        let c = 0;\n        while (c < sampleCount) {\n          trafficAVG = trafficAVG + response.values[c][1];\n          metricAVG = metricAVG + response.values[c][2];\n          if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n          c++;\n        }\n        let i2 = 0;\n        let i2A = 0;\n        let i2B = 0;\n          while (i2 < sampleCount) {\n                if (response.values[i2][1]>(trafficAVG/sampleCount))\n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricAAVG=metricAAVG+response.values[i2][2];\n                    trafficAAVG=trafficAAVG+response.values[i2][1];\n                    i2A++;\n                        }\n                  }\n                if (response.values[i2][1]<(trafficAVG/sampleCount)) \n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricBAVG=metricBAVG+response.values[i2][2];\n                    trafficBAVG=trafficBAVG+response.values[i2][1];\n                    i2B++;\n                        }\n                  }\n                i2++;\n              }\n        if (metricBAVG==0) metricBAVG=1;\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n        if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n        responseActions.values[actions][1]=metricAVG;\n        responseActions.values[actions][2]=predictedMetric;\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG)\n  console.log(\"Metric Average:\",metricAVG)\n  console.log(\"Metric Above:\",metricAAVG)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n    }\n  \n    return {\n    records: new Array(responseActions.values.length).fill(null).map((_, index, array) => {\n      return {\n        'Location': responseActions.values[index][0],\n        'Errors': responseActions.values[index][1],\n        'Prediction': responseActions.values[index][2],\n        'Change': responseActions.values[index][2]-responseActions.values[index][1]\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n          'Location': { type: 'string' },\n          'Errors': { type: 'double' },\n          'Prediction': { type: 'double' },\n          'Change': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Errors","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.5},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":1}]},{"id":2,"field":"Prediction","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.5},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":1}]},{"id":3,"field":"Change","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":-999999999},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.05},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":0.1}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"Location","categoryAxisLabel":"Location","valueAxis":"Errors","valueAxisLabel":"Errors"}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"Location"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"User Action\"]":272.84375,"[\"Errors\"]":87.875,"[\"Prediction\"]":112.734375,"[\"Change\"]":95.796875},"sortBy":{"columnId":"[\"Change\"]","direction":"descending"}},"unitsOverrides":[{"identifier":"Prediction","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734},{"identifier":"Errors","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1704583008650},{"identifier":"Change","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583201091}],"histogram":{"dataMappings":[{"valueAxis":"Errors","rangeAxis":""},{"valueAxis":"Prediction","rangeAxis":""},{"valueAxis":"Change","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"42":{"type":"code","title":"Traffic Impact on $EnvironmentFilter JavaScript Error Rate","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"javascriptErrorCount\";\n  const metricName = \"Error Rate\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }  \n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Get Locations\n  var usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null order by D1 DESC limit 100';\n  if ($ActionCategory==\"Key\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null and keyuseraction is true limit 100';\n  if ($ActionCategory==\"Entry\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null and isentryaction is true  limit 100';\n  if ($ActionCategory==\"Exit\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$EnvironmentFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$EnvironmentFilter+' is not null and isexitaction is true limit 100';\n  const responseActions = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQueryActions, startTimestamp: startTime, endTimestamp: endTime});\n  // Loop thru each Location\n  for (var actions = 0; actions < responseActions.values.length; actions++) {\n        responseActions.values[actions][0] = responseActions.values[actions][0].replace(/\"/g, \"\\\"\\\"\");\n        // Get traffic and metric details\n        var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n        if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n        if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n        if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$EnvironmentFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n        var response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n        // Toss last 30 minutes\n        var sampleCount = response.values.length-6;\n        let percentChangeMetric = 0;\n        let percentChangeTraffic = 0;\n        let trafficAVG = 0;\n        let metricAVG = 0;\n        let metricMIN = response.values[0][2];\n        let metricAAVG = 0;\n        let metricBAVG = 0;\n        let trafficAAVG = 0;\n        let trafficBAVG = 0;\n        let c = 0;\n        while (c < sampleCount) {\n          trafficAVG = trafficAVG + response.values[c][1];\n          metricAVG = metricAVG + response.values[c][2];\n          if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n          c++;\n        }\n        let i2 = 0;\n        let i2A = 0;\n        let i2B = 0;\n          while (i2 < sampleCount) {\n                if (response.values[i2][1]>(trafficAVG/sampleCount))\n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricAAVG=metricAAVG+response.values[i2][2];\n                    trafficAAVG=trafficAAVG+response.values[i2][1];\n                    i2A++;\n                        }\n                  }\n                if (response.values[i2][1]<(trafficAVG/sampleCount)) \n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricBAVG=metricBAVG+response.values[i2][2];\n                    trafficBAVG=trafficBAVG+response.values[i2][1];\n                    i2B++;\n                        }\n                  }\n                i2++;\n              }\n        if (metricBAVG==0) metricBAVG=1;\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n        if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n        responseActions.values[actions][1]=metricAVG;\n        responseActions.values[actions][2]=predictedMetric;\n    }\n  \n    return {\n    records: new Array(responseActions.values.length).fill(null).map((_, index, array) => {\n      return {\n        'Environment': responseActions.values[index][0],\n        'Errors': responseActions.values[index][1],\n        'Prediction': responseActions.values[index][2],\n        'Change': responseActions.values[index][2]-responseActions.values[index][1]\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n          'Environment': { type: 'string' },\n          'Errors': { type: 'double' },\n          'Prediction': { type: 'double' },\n          'Change': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Errors","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.5},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":1}]},{"id":2,"field":"Prediction","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.5},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":1}]},{"id":3,"field":"Change","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¥","label":"","value":-99999999},{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.05},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":0.1}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"Environment","categoryAxisLabel":"Environment","valueAxis":"Errors","valueAxisLabel":"Errors"}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"Environment"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"User Action\"]":272.84375,"[\"Errors\"]":87.875,"[\"Prediction\"]":112.734375,"[\"Change\"]":95.796875},"sortBy":{"columnId":"[\"Change\"]","direction":"descending"}},"unitsOverrides":[{"identifier":"Prediction","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734},{"identifier":"Errors","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1704583008650},{"identifier":"Change","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583201091}],"histogram":{"dataMappings":[{"valueAxis":"Errors","rangeAxis":""},{"valueAxis":"Prediction","rangeAxis":""},{"valueAxis":"Change","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"43":{"type":"code","title":"Traffic Impact on User Action Request Errors","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"requestErrorCount\";\n  const metricName = \"Error Rate\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Get useraction names\n  var usqlQueryActions = 'SELECT DISTINCT name,sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' order by D1 DESC limit 100';\n  if ($ActionCategory==\"Key\") usqlQueryActions = 'SELECT DISTINCT name,sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 100';\n  if ($ActionCategory==\"Entry\") usqlQueryActions = 'SELECT DISTINCT name,sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 100';\n  if ($ActionCategory==\"Exit\") usqlQueryActions = 'SELECT DISTINCT name,sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 100';\n  const responseActions = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQueryActions, startTimestamp: startTime, endTimestamp: endTime});\n  // Loop thru each useraction\n  for (var actions = 0; actions < responseActions.values.length; actions++) {\n        responseActions.values[actions][0] = responseActions.values[actions][0].replace(/\"/g, \"\\\"\\\"\");\n        // Get traffic and metric details\n        var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n        if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n        if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n        if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n        var response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n        // Toss last 30 minutes\n        var sampleCount = response.values.length-6;\n        let percentChangeMetric = 0;\n        let percentChangeTraffic = 0;\n        let trafficAVG = 0;\n        let metricAVG = 0;\n        let metricMIN = response.values[0][2];\n        let metricAAVG = 0;\n        let metricBAVG = 0;\n        let trafficAAVG = 0;\n        let trafficBAVG = 0;\n        let c = 0;\n        while (c < sampleCount) {\n          trafficAVG = trafficAVG + response.values[c][1];\n          metricAVG = metricAVG + response.values[c][2];\n          if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n          c++;\n        }\n        let i2 = 0;\n        let i2A = 0;\n        let i2B = 0;\n          while (i2 < sampleCount) {\n                if (response.values[i2][1]>(trafficAVG/sampleCount))\n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricAAVG=metricAAVG+response.values[i2][2];\n                    trafficAAVG=trafficAAVG+response.values[i2][1];\n                    i2A++;\n                        }\n                  }\n                if (response.values[i2][1]<(trafficAVG/sampleCount)) \n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricBAVG=metricBAVG+response.values[i2][2];\n                    trafficBAVG=trafficBAVG+response.values[i2][1];\n                    i2B++;\n                        }\n                  }\n                i2++;\n              }\n        if (metricBAVG==0) metricBAVG=1;\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n        if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n        responseActions.values[actions][1]=metricAVG;\n        responseActions.values[actions][2]=predictedMetric;\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG)\n  console.log(\"Metric Average:\",metricAVG)\n  console.log(\"Metric Above:\",metricAAVG)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n    }\n  \n    return {\n    records: new Array(responseActions.values.length).fill(null).map((_, index, array) => {\n      return {\n        'User Action': responseActions.values[index][0],\n        'Errors': responseActions.values[index][1],\n        'Prediction': responseActions.values[index][2],\n        'Change': responseActions.values[index][2]-responseActions.values[index][1]\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n          'User Action': { type: 'string' },\n          'Errors': { type: 'double' },\n          'Prediction': { type: 'double' },\n          'Change': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Errors","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":">","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":5},{"id":3,"color":"#00D26A","comparator":"â‰¤","label":"","value":0}]},{"id":2,"field":"Prediction","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":">","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":5},{"id":3,"color":"#00D26A","comparator":"â‰¤","label":"","value":0}]},{"id":3,"field":"Change","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":">","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":5},{"id":3,"color":"#00D26A","comparator":"â‰¤","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"User Action","categoryAxisLabel":"User Action","valueAxis":"Errors","valueAxisLabel":"Errors"}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"User Action"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"User Action\"]":255,"[\"Errors\"]":87.875,"[\"Prediction\"]":112.734375,"[\"Change\"]":95.796875},"sortBy":{"columnId":"[\"Change\"]","direction":"descending"}},"unitsOverrides":[{"identifier":"Prediction","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734},{"identifier":"Errors","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1704583008650},{"identifier":"Change","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583201091}],"histogram":{"dataMappings":[{"valueAxis":"Errors","rangeAxis":""},{"valueAxis":"Prediction","rangeAxis":""},{"valueAxis":"Change","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"44":{"type":"code","title":"Traffic Impact on User Action JavaScript Errors","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"javascriptErrorCount\";\n  const metricName = \"Error Rate\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Get useraction names\n  var usqlQueryActions = 'SELECT DISTINCT name,sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' order by D1 DESC limit 100';\n  if ($ActionCategory==\"Key\") usqlQueryActions = 'SELECT DISTINCT name,sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 100';\n  if ($ActionCategory==\"Entry\") usqlQueryActions = 'SELECT DISTINCT name,sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 100';\n  if ($ActionCategory==\"Exit\") usqlQueryActions = 'SELECT DISTINCT name,sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 100';\n  const responseActions = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQueryActions, startTimestamp: startTime, endTimestamp: endTime});\n  // Loop thru each useraction\n  for (var actions = 0; actions < responseActions.values.length; actions++) {\n        responseActions.values[actions][0] = responseActions.values[actions][0].replace(/\"/g, \"\\\"\\\"\");\n        // Get traffic and metric details\n        var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n        if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n        if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n        if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where name=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n        var response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n        // Toss last 30 minutes\n        var sampleCount = response.values.length-6;\n        let percentChangeMetric = 0;\n        let percentChangeTraffic = 0;\n        let trafficAVG = 0;\n        let metricAVG = 0;\n        let metricMIN = response.values[0][2];\n        let metricAAVG = 0;\n        let metricBAVG = 0;\n        let trafficAAVG = 0;\n        let trafficBAVG = 0;\n        let c = 0;\n        while (c < sampleCount) {\n          trafficAVG = trafficAVG + response.values[c][1];\n          metricAVG = metricAVG + response.values[c][2];\n          if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n          c++;\n        }\n        let i2 = 0;\n        let i2A = 0;\n        let i2B = 0;\n          while (i2 < sampleCount) {\n                if (response.values[i2][1]>(trafficAVG/sampleCount))\n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricAAVG=metricAAVG+response.values[i2][2];\n                    trafficAAVG=trafficAAVG+response.values[i2][1];\n                    i2A++;\n                        }\n                  }\n                if (response.values[i2][1]<(trafficAVG/sampleCount)) \n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricBAVG=metricBAVG+response.values[i2][2];\n                    trafficBAVG=trafficBAVG+response.values[i2][1];\n                    i2B++;\n                        }\n                  }\n                i2++;\n              }\n        if (metricBAVG==0) metricBAVG=1;\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n        if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n        responseActions.values[actions][1]=metricAVG;\n        responseActions.values[actions][2]=predictedMetric;\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG)\n  console.log(\"Metric Average:\",metricAVG)\n  console.log(\"Metric Above:\",metricAAVG)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n    }\n  \n    return {\n    records: new Array(responseActions.values.length).fill(null).map((_, index, array) => {\n      return {\n        'User Action': responseActions.values[index][0],\n        'Errors': responseActions.values[index][1],\n        'Prediction': responseActions.values[index][2],\n        'Change': responseActions.values[index][2]-responseActions.values[index][1]\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n          'User Action': { type: 'string' },\n          'Errors': { type: 'double' },\n          'Prediction': { type: 'double' },\n          'Change': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Errors","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.5},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":1},{"id":3,"color":"#00D26A","comparator":"â‰¥","label":"","value":0}]},{"id":2,"field":"Prediction","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.5},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":1},{"id":3,"color":"#00D26A","comparator":"â‰¥","label":"","value":0}]},{"id":3,"field":"Change","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":"â‰¥","label":"","value":0.05},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":0.1},{"id":3,"color":"#00D26A","comparator":"â‰¥","label":"","value":-99999999}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"User Action","categoryAxisLabel":"User Action","valueAxis":"Errors","valueAxisLabel":"Errors"}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"User Action"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"User Action\"]":279,"[\"Errors\"]":87.875,"[\"Prediction\"]":112.734375,"[\"Change\"]":95.796875},"sortBy":{"columnId":"[\"Change\"]","direction":"descending"}},"unitsOverrides":[{"identifier":"Prediction","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734},{"identifier":"Errors","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1704583008650},{"identifier":"Change","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583201091}],"histogram":{"dataMappings":[{"valueAxis":"Errors","rangeAxis":""},{"valueAxis":"Prediction","rangeAxis":""},{"valueAxis":"Change","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"46":{"type":"code","title":"Traffic Impact on $LocationFilter Request Errors","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"requestErrorCount\";\n  const metricName = \"Error Rate\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Get Locations\n  var usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null order by D1 DESC limit 100';\n  if ($ActionCategory==\"Key\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null and keyuseraction is true limit 100';\n  if ($ActionCategory==\"Entry\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null and isentryaction is true  limit 100';\n  if ($ActionCategory==\"Exit\") usqlQueryActions = 'SELECT DISTINCT usersession.'+$LocationFilter+',sum('+metric+') as D1 from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and usersession.'+$LocationFilter+' is not null and isexitaction is true limit 100';\n  const responseActions = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQueryActions, startTimestamp: startTime, endTimestamp: endTime});\n  // Loop thru each Location\n  for (var actions = 0; actions < responseActions.values.length; actions++) {\n        responseActions.values[actions][0] = responseActions.values[actions][0].replace(/\"/g, \"\\\"\\\"\");\n        // Get traffic and metric details\n        var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n        if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n        if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n        if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", CONDITION (sum('+metric+'), where usersession.'+$LocationFilter+'=\"'+responseActions.values[actions][0]+'\")  AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n        var response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n        // Toss last 30 minutes\n        var sampleCount = response.values.length-6;\n        let percentChangeMetric = 0;\n        let percentChangeTraffic = 0;\n        let trafficAVG = 0;\n        let metricAVG = 0;\n        let metricMIN = response.values[0][2];\n        let metricAAVG = 0;\n        let metricBAVG = 0;\n        let trafficAAVG = 0;\n        let trafficBAVG = 0;\n        let c = 0;\n        while (c < sampleCount) {\n          trafficAVG = trafficAVG + response.values[c][1];\n          metricAVG = metricAVG + response.values[c][2];\n          if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n          c++;\n        }\n        let i2 = 0;\n        let i2A = 0;\n        let i2B = 0;\n          while (i2 < sampleCount) {\n                if (response.values[i2][1]>(trafficAVG/sampleCount))\n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricAAVG=metricAAVG+response.values[i2][2];\n                    trafficAAVG=trafficAAVG+response.values[i2][1];\n                    i2A++;\n                        }\n                  }\n                if (response.values[i2][1]<(trafficAVG/sampleCount)) \n                  {\n                    if (response.values[i2][2]!=null)\n                      {\n                    metricBAVG=metricBAVG+response.values[i2][2];\n                    trafficBAVG=trafficBAVG+response.values[i2][1];\n                    i2B++;\n                        }\n                  }\n                i2++;\n              }\n        if (metricBAVG==0) metricBAVG=1;\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n        if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n        responseActions.values[actions][1]=metricAVG;\n        responseActions.values[actions][2]=predictedMetric;\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG)\n  console.log(\"Metric Average:\",metricAVG)\n  console.log(\"Metric Above:\",metricAAVG)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n    }\n  \n    return {\n    records: new Array(responseActions.values.length).fill(null).map((_, index, array) => {\n      return {\n        'Location': responseActions.values[index][0],\n        'Errors': responseActions.values[index][1],\n        'Prediction': responseActions.values[index][2],\n        'Change': responseActions.values[index][2]-responseActions.values[index][1]\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n          'Location': { type: 'string' },\n          'Errors': { type: 'double' },\n          'Prediction': { type: 'double' },\n          'Change': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Errors","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":">","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":5},{"id":3,"color":"#00D26A","comparator":"â‰¤","label":""}]},{"id":2,"field":"Prediction","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":">","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":5},{"id":3,"color":"#00D26A","comparator":"â‰¤","label":""}]},{"id":3,"field":"Change","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":">","label":"","value":0},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":5},{"id":3,"color":"#00D26A","comparator":"â‰¤","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"Location","categoryAxisLabel":"Location","valueAxis":"Errors","valueAxisLabel":"Errors"}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"start","recordField":"Location"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"User Action\"]":169,"[\"Errors\"]":87.875,"[\"Prediction\"]":112.734375,"[\"Change\"]":95.796875},"sortBy":{"columnId":"[\"Change\"]","direction":"descending"}},"unitsOverrides":[{"identifier":"Prediction","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734},{"identifier":"Errors","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":0,"suffix":"","delimiter":false,"added":1704583008650},{"identifier":"Change","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704583201091}],"histogram":{"dataMappings":[{"valueAxis":"Errors","rangeAxis":""},{"valueAxis":"Prediction","rangeAxis":""},{"valueAxis":"Change","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"47":{"type":"code","title":"Request Error Change","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"requestErrorCount\";\n  const metricName = \"Error Count\";\n  const metricAgg = \"sum\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n  return (($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric)+0;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¤","label":"","value":-3},{"id":1,"color":"#FCD53F","comparator":">","label":"","value":-3},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":3}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":"percent","decimals":2,"suffix":"%","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"48":{"type":"code","title":"JavaScript Error Change","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = \"javascriptErrorCount\";\n  const metricName = \"Error Count\";\n  const metricAgg = \"sum\";\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and usersession.starttime>='+startTime+' and usersession.endtime<='+endTime+' and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: startTime, endTimestamp: endTime});\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let percentChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  percentChangeMetric = (((metricAAVG/i2A) - (metricBAVG/i2B))/(((metricAAVG/i2A) + (metricBAVG/i2B))/2)*100)\n  percentChangeTraffic = (((trafficAAVG/i2A) - (trafficBAVG/i2B))/(((trafficAAVG/i2A) + (trafficBAVG/i2B))/2)*100)\n  var predictedMetric = (metricAVG/sampleCount) + ((percentChangeMetric/percentChangeTraffic)*$TrafficChangePercent)\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",percentChangeMetric)\n  console.log(\"Predicted Metric:\",predictedMetric)\n  if (predictedMetric<metricMIN) predictedMetric=metricMIN;\n  return (($TrafficChangePercent/percentChangeTraffic)*percentChangeMetric)+0;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"â‰¤","label":"","value":-3},{"id":1,"color":"#FCD53F","comparator":">","label":"","value":-3},{"id":2,"color":"#F8312F","comparator":"â‰¥","label":"","value":3}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":"percent","decimals":2,"suffix":"%","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"49":{"type":"markdown","title":"","content":"[**Help**](https://github.com/TechShady/Dynatrace-Dashboards-Gen3/blob/main/ReadMeTrafficSimulator.md#user-guide)"},"50":{"type":"markdown","title":"","content":"# \n# ðŸ”Ž Traffic Simulator"}},"layouts":{"2":{"x":4,"y":4,"w":20,"h":2},"5":{"x":0,"y":4,"w":4,"h":2},"7":{"x":0,"y":11,"w":8,"h":9},"10":{"x":12,"y":1,"w":4,"h":2},"11":{"x":0,"y":0,"w":24,"h":1},"12":{"x":0,"y":3,"w":24,"h":1},"14":{"x":0,"y":33,"w":22,"h":1},"15":{"x":0,"y":10,"w":24,"h":1},"17":{"x":16,"y":1,"w":4,"h":2},"18":{"x":4,"y":6,"w":20,"h":2},"20":{"x":4,"y":8,"w":20,"h":2},"21":{"x":20,"y":1,"w":4,"h":2},"22":{"x":8,"y":1,"w":4,"h":2},"24":{"x":8,"y":11,"w":8,"h":9},"25":{"x":16,"y":11,"w":8,"h":9},"32":{"x":0,"y":20,"w":24,"h":1},"35":{"x":0,"y":21,"w":8,"h":4},"36":{"x":0,"y":25,"w":8,"h":4},"37":{"x":0,"y":29,"w":8,"h":4},"39":{"x":8,"y":29,"w":8,"h":4},"40":{"x":16,"y":25,"w":8,"h":4},"42":{"x":16,"y":29,"w":8,"h":4},"43":{"x":8,"y":21,"w":8,"h":4},"44":{"x":16,"y":21,"w":8,"h":4},"46":{"x":8,"y":25,"w":8,"h":4},"47":{"x":0,"y":6,"w":4,"h":2},"48":{"x":0,"y":8,"w":4,"h":2},"49":{"x":22,"y":33,"w":2,"h":1},"50":{"x":0,"y":1,"w":8,"h":2}}}